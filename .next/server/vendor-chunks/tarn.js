"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/tarn";
exports.ids = ["vendor-chunks/tarn"];
exports.modules = {

/***/ "(rsc)/./node_modules/tarn/dist/PendingOperation.js":
/*!****************************************************!*\
  !*** ./node_modules/tarn/dist/PendingOperation.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nconst TimeoutError_1 = __webpack_require__(/*! ./TimeoutError */ \"(rsc)/./node_modules/tarn/dist/TimeoutError.js\");\r\nconst utils_1 = __webpack_require__(/*! ./utils */ \"(rsc)/./node_modules/tarn/dist/utils.js\");\r\nclass PendingOperation {\r\n    constructor(timeoutMillis) {\r\n        this.timeoutMillis = timeoutMillis;\r\n        this.deferred = utils_1.defer();\r\n        this.possibleTimeoutCause = null;\r\n        this.isRejected = false;\r\n        this.promise = timeout(this.deferred.promise, timeoutMillis).catch(err => {\r\n            if (err instanceof TimeoutError_1.TimeoutError) {\r\n                if (this.possibleTimeoutCause) {\r\n                    err = new TimeoutError_1.TimeoutError(this.possibleTimeoutCause.message);\r\n                }\r\n                else {\r\n                    err = new TimeoutError_1.TimeoutError('operation timed out for an unknown reason');\r\n                }\r\n            }\r\n            this.isRejected = true;\r\n            return Promise.reject(err);\r\n        });\r\n    }\r\n    abort() {\r\n        this.reject(new Error('aborted'));\r\n    }\r\n    reject(err) {\r\n        this.deferred.reject(err);\r\n    }\r\n    resolve(value) {\r\n        this.deferred.resolve(value);\r\n    }\r\n}\r\nexports.PendingOperation = PendingOperation;\r\nfunction timeout(promise, time) {\r\n    return new Promise((resolve, reject) => {\r\n        const timeoutHandle = setTimeout(() => reject(new TimeoutError_1.TimeoutError()), time);\r\n        promise\r\n            .then(result => {\r\n            clearTimeout(timeoutHandle);\r\n            resolve(result);\r\n        })\r\n            .catch(err => {\r\n            clearTimeout(timeoutHandle);\r\n            reject(err);\r\n        });\r\n    });\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdGFybi9kaXN0L1BlbmRpbmdPcGVyYXRpb24uanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsdUJBQXVCLG1CQUFPLENBQUMsc0VBQWdCO0FBQy9DLGdCQUFnQixtQkFBTyxDQUFDLHdEQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGpzLXR5cGVzY3JpcHQtcmVkdXgtc2FtcGxlLy4vbm9kZV9tb2R1bGVzL3Rhcm4vZGlzdC9QZW5kaW5nT3BlcmF0aW9uLmpzPzhjOTYiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3QgVGltZW91dEVycm9yXzEgPSByZXF1aXJlKFwiLi9UaW1lb3V0RXJyb3JcIik7XHJcbmNvbnN0IHV0aWxzXzEgPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcclxuY2xhc3MgUGVuZGluZ09wZXJhdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih0aW1lb3V0TWlsbGlzKSB7XHJcbiAgICAgICAgdGhpcy50aW1lb3V0TWlsbGlzID0gdGltZW91dE1pbGxpcztcclxuICAgICAgICB0aGlzLmRlZmVycmVkID0gdXRpbHNfMS5kZWZlcigpO1xyXG4gICAgICAgIHRoaXMucG9zc2libGVUaW1lb3V0Q2F1c2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNSZWplY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IHRpbWVvdXQodGhpcy5kZWZlcnJlZC5wcm9taXNlLCB0aW1lb3V0TWlsbGlzKS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgVGltZW91dEVycm9yXzEuVGltZW91dEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wb3NzaWJsZVRpbWVvdXRDYXVzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVyciA9IG5ldyBUaW1lb3V0RXJyb3JfMS5UaW1lb3V0RXJyb3IodGhpcy5wb3NzaWJsZVRpbWVvdXRDYXVzZS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVyciA9IG5ldyBUaW1lb3V0RXJyb3JfMS5UaW1lb3V0RXJyb3IoJ29wZXJhdGlvbiB0aW1lZCBvdXQgZm9yIGFuIHVua25vd24gcmVhc29uJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5pc1JlamVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBhYm9ydCgpIHtcclxuICAgICAgICB0aGlzLnJlamVjdChuZXcgRXJyb3IoJ2Fib3J0ZWQnKSk7XHJcbiAgICB9XHJcbiAgICByZWplY3QoZXJyKSB7XHJcbiAgICAgICAgdGhpcy5kZWZlcnJlZC5yZWplY3QoZXJyKTtcclxuICAgIH1cclxuICAgIHJlc29sdmUodmFsdWUpIHtcclxuICAgICAgICB0aGlzLmRlZmVycmVkLnJlc29sdmUodmFsdWUpO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuUGVuZGluZ09wZXJhdGlvbiA9IFBlbmRpbmdPcGVyYXRpb247XHJcbmZ1bmN0aW9uIHRpbWVvdXQocHJvbWlzZSwgdGltZSkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBjb25zdCB0aW1lb3V0SGFuZGxlID0gc2V0VGltZW91dCgoKSA9PiByZWplY3QobmV3IFRpbWVvdXRFcnJvcl8xLlRpbWVvdXRFcnJvcigpKSwgdGltZSk7XHJcbiAgICAgICAgcHJvbWlzZVxyXG4gICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dEhhbmRsZSk7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRIYW5kbGUpO1xyXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/tarn/dist/PendingOperation.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/tarn/dist/Pool.js":
/*!****************************************!*\
  !*** ./node_modules/tarn/dist/Pool.js ***!
  \****************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nconst PendingOperation_1 = __webpack_require__(/*! ./PendingOperation */ \"(rsc)/./node_modules/tarn/dist/PendingOperation.js\");\r\nconst Resource_1 = __webpack_require__(/*! ./Resource */ \"(rsc)/./node_modules/tarn/dist/Resource.js\");\r\nconst utils_1 = __webpack_require__(/*! ./utils */ \"(rsc)/./node_modules/tarn/dist/utils.js\");\r\nconst events_1 = __webpack_require__(/*! events */ \"events\");\r\nconst timers_1 = __webpack_require__(/*! timers */ \"timers\");\r\nclass Pool {\r\n    constructor(opt) {\r\n        this.destroyed = false;\r\n        this.emitter = new events_1.EventEmitter();\r\n        opt = opt || {};\r\n        if (!opt.create) {\r\n            throw new Error('Tarn: opt.create function most be provided');\r\n        }\r\n        if (!opt.destroy) {\r\n            throw new Error('Tarn: opt.destroy function most be provided');\r\n        }\r\n        if (typeof opt.min !== 'number' || opt.min < 0 || opt.min !== Math.round(opt.min)) {\r\n            throw new Error('Tarn: opt.min must be an integer >= 0');\r\n        }\r\n        if (typeof opt.max !== 'number' || opt.max <= 0 || opt.max !== Math.round(opt.max)) {\r\n            throw new Error('Tarn: opt.max must be an integer > 0');\r\n        }\r\n        if (opt.min > opt.max) {\r\n            throw new Error('Tarn: opt.max is smaller than opt.min');\r\n        }\r\n        if (!utils_1.checkOptionalTime(opt.acquireTimeoutMillis)) {\r\n            throw new Error('Tarn: invalid opt.acquireTimeoutMillis ' + JSON.stringify(opt.acquireTimeoutMillis));\r\n        }\r\n        if (!utils_1.checkOptionalTime(opt.createTimeoutMillis)) {\r\n            throw new Error('Tarn: invalid opt.createTimeoutMillis ' + JSON.stringify(opt.createTimeoutMillis));\r\n        }\r\n        if (!utils_1.checkOptionalTime(opt.destroyTimeoutMillis)) {\r\n            throw new Error('Tarn: invalid opt.destroyTimeoutMillis ' + JSON.stringify(opt.destroyTimeoutMillis));\r\n        }\r\n        if (!utils_1.checkOptionalTime(opt.idleTimeoutMillis)) {\r\n            throw new Error('Tarn: invalid opt.idleTimeoutMillis ' + JSON.stringify(opt.idleTimeoutMillis));\r\n        }\r\n        if (!utils_1.checkOptionalTime(opt.reapIntervalMillis)) {\r\n            throw new Error('Tarn: invalid opt.reapIntervalMillis ' + JSON.stringify(opt.reapIntervalMillis));\r\n        }\r\n        if (!utils_1.checkOptionalTime(opt.createRetryIntervalMillis)) {\r\n            throw new Error('Tarn: invalid opt.createRetryIntervalMillis ' +\r\n                JSON.stringify(opt.createRetryIntervalMillis));\r\n        }\r\n        const allowedKeys = {\r\n            create: true,\r\n            validate: true,\r\n            destroy: true,\r\n            log: true,\r\n            min: true,\r\n            max: true,\r\n            acquireTimeoutMillis: true,\r\n            createTimeoutMillis: true,\r\n            destroyTimeoutMillis: true,\r\n            idleTimeoutMillis: true,\r\n            reapIntervalMillis: true,\r\n            createRetryIntervalMillis: true,\r\n            propagateCreateError: true\r\n        };\r\n        for (const key of Object.keys(opt)) {\r\n            if (!allowedKeys[key]) {\r\n                throw new Error(`Tarn: unsupported option opt.${key}`);\r\n            }\r\n        }\r\n        this.creator = opt.create;\r\n        this.destroyer = opt.destroy;\r\n        this.validate = typeof opt.validate === 'function' ? opt.validate : () => true;\r\n        this.log = opt.log || (() => { });\r\n        this.acquireTimeoutMillis = opt.acquireTimeoutMillis || 30000;\r\n        this.createTimeoutMillis = opt.createTimeoutMillis || 30000;\r\n        this.destroyTimeoutMillis = opt.destroyTimeoutMillis || 5000;\r\n        this.idleTimeoutMillis = opt.idleTimeoutMillis || 30000;\r\n        this.reapIntervalMillis = opt.reapIntervalMillis || 1000;\r\n        this.createRetryIntervalMillis = opt.createRetryIntervalMillis || 200;\r\n        this.propagateCreateError = !!opt.propagateCreateError;\r\n        this.min = opt.min;\r\n        this.max = opt.max;\r\n        // All the resources, which are either already acquired or which are\r\n        // considered for being passed to acquire in async validation phase.\r\n        this.used = [];\r\n        // All the resources, which are either just created and free or returned\r\n        // back to pool after using.\r\n        this.free = [];\r\n        this.pendingCreates = [];\r\n        this.pendingAcquires = [];\r\n        this.pendingDestroys = [];\r\n        // When acquire is pending, but also still in validation phase\r\n        this.pendingValidations = [];\r\n        this.destroyed = false;\r\n        this.interval = null;\r\n        this.eventId = 1;\r\n    }\r\n    numUsed() {\r\n        return this.used.length;\r\n    }\r\n    numFree() {\r\n        return this.free.length;\r\n    }\r\n    numPendingAcquires() {\r\n        return this.pendingAcquires.length;\r\n    }\r\n    numPendingValidations() {\r\n        return this.pendingValidations.length;\r\n    }\r\n    numPendingCreates() {\r\n        return this.pendingCreates.length;\r\n    }\r\n    acquire() {\r\n        const eventId = this.eventId++;\r\n        this._executeEventHandlers('acquireRequest', eventId);\r\n        const pendingAcquire = new PendingOperation_1.PendingOperation(this.acquireTimeoutMillis);\r\n        this.pendingAcquires.push(pendingAcquire);\r\n        // If the acquire fails for whatever reason\r\n        // remove it from the pending queue.\r\n        pendingAcquire.promise = pendingAcquire.promise\r\n            .then(resource => {\r\n            this._executeEventHandlers('acquireSuccess', eventId, resource);\r\n            return resource;\r\n        })\r\n            .catch(err => {\r\n            this._executeEventHandlers('acquireFail', eventId, err);\r\n            remove(this.pendingAcquires, pendingAcquire);\r\n            return Promise.reject(err);\r\n        });\r\n        this._tryAcquireOrCreate();\r\n        return pendingAcquire;\r\n    }\r\n    release(resource) {\r\n        this._executeEventHandlers('release', resource);\r\n        for (let i = 0, l = this.used.length; i < l; ++i) {\r\n            const used = this.used[i];\r\n            if (used.resource === resource) {\r\n                this.used.splice(i, 1);\r\n                this.free.push(used.resolve());\r\n                this._tryAcquireOrCreate();\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    isEmpty() {\r\n        return ([\r\n            this.numFree(),\r\n            this.numUsed(),\r\n            this.numPendingAcquires(),\r\n            this.numPendingValidations(),\r\n            this.numPendingCreates()\r\n        ].reduce((total, value) => total + value) === 0);\r\n    }\r\n    /**\r\n     * Reaping cycle.\r\n     */\r\n    check() {\r\n        const timestamp = utils_1.now();\r\n        const newFree = [];\r\n        const minKeep = this.min - this.used.length;\r\n        const maxDestroy = this.free.length - minKeep;\r\n        let numDestroyed = 0;\r\n        this.free.forEach(free => {\r\n            if (utils_1.duration(timestamp, free.timestamp) >= this.idleTimeoutMillis &&\r\n                numDestroyed < maxDestroy) {\r\n                numDestroyed++;\r\n                this._destroy(free.resource);\r\n            }\r\n            else {\r\n                newFree.push(free);\r\n            }\r\n        });\r\n        this.free = newFree;\r\n        // Pool is completely empty, stop reaping.\r\n        // Next .acquire will start reaping interval again.\r\n        if (this.isEmpty()) {\r\n            this._stopReaping();\r\n        }\r\n    }\r\n    destroy() {\r\n        const eventId = this.eventId++;\r\n        this._executeEventHandlers('poolDestroyRequest', eventId);\r\n        this._stopReaping();\r\n        this.destroyed = true;\r\n        // First wait for all the pending creates get ready.\r\n        return utils_1.reflect(Promise.all(this.pendingCreates.map(create => utils_1.reflect(create.promise)))\r\n            .then(() => {\r\n            // eslint-disable-next-line\r\n            return new Promise((resolve, reject) => {\r\n                // poll every 100ms and wait that all validations are ready\r\n                if (this.numPendingValidations() === 0) {\r\n                    resolve();\r\n                    return;\r\n                }\r\n                const interval = setInterval(() => {\r\n                    if (this.numPendingValidations() === 0) {\r\n                        timers_1.clearInterval(interval);\r\n                        resolve();\r\n                    }\r\n                }, 100);\r\n            });\r\n        })\r\n            .then(() => {\r\n            // Wait for all the used resources to be freed.\r\n            return Promise.all(this.used.map(used => utils_1.reflect(used.promise)));\r\n        })\r\n            .then(() => {\r\n            // Abort all pending acquires.\r\n            return Promise.all(this.pendingAcquires.map(acquire => {\r\n                acquire.abort();\r\n                return utils_1.reflect(acquire.promise);\r\n            }));\r\n        })\r\n            .then(() => {\r\n            // Now we can destroy all the freed resources.\r\n            return Promise.all(this.free.map(free => utils_1.reflect(this._destroy(free.resource))));\r\n        })\r\n            .then(() => {\r\n            // Also wait rest of the pending destroys to finish\r\n            return Promise.all(this.pendingDestroys.map(pd => pd.promise));\r\n        })\r\n            .then(() => {\r\n            this.free = [];\r\n            this.pendingAcquires = [];\r\n        })).then(res => {\r\n            this._executeEventHandlers('poolDestroySuccess', eventId);\r\n            this.emitter.removeAllListeners();\r\n            return res;\r\n        });\r\n    }\r\n    on(event, listener) {\r\n        this.emitter.on(event, listener);\r\n    }\r\n    removeListener(event, listener) {\r\n        this.emitter.removeListener(event, listener);\r\n    }\r\n    removeAllListeners(event) {\r\n        this.emitter.removeAllListeners(event);\r\n    }\r\n    /**\r\n     * The most important method that is called always when resources\r\n     * are created / destroyed / acquired / released. In other words\r\n     * every time when resources are moved from used to free or vice\r\n     * versa.\r\n     *\r\n     * Either assigns free resources to pendingAcquires or creates new\r\n     * resources if there is room for it in the pool.\r\n     */\r\n    _tryAcquireOrCreate() {\r\n        if (this.destroyed) {\r\n            return;\r\n        }\r\n        if (this._hasFreeResources()) {\r\n            this._doAcquire();\r\n        }\r\n        else if (this._shouldCreateMoreResources()) {\r\n            this._doCreate();\r\n        }\r\n    }\r\n    _hasFreeResources() {\r\n        return this.free.length > 0;\r\n    }\r\n    _doAcquire() {\r\n        // Acquire as many pending acquires as possible concurrently\r\n        while (this._canAcquire()) {\r\n            // To allow async validation, we actually need to move free resource\r\n            // and pending acquire temporary from their respective arrays and depending\r\n            // on validation result to either leave the free resource to used resources array\r\n            // or destroy the free resource if validation did fail.\r\n            const pendingAcquire = this.pendingAcquires.shift();\r\n            const free = this.free.pop();\r\n            if (free === undefined || pendingAcquire === undefined) {\r\n                const errMessage = 'this.free was empty while trying to acquire resource';\r\n                this.log(`Tarn: ${errMessage}`, 'warn');\r\n                throw new Error(`Internal error, should never happen. ${errMessage}`);\r\n            }\r\n            // Make sure that pendingAcquire that is being validated is not lost and\r\n            // can be freed when pool is destroyed.\r\n            this.pendingValidations.push(pendingAcquire);\r\n            // Must be added here pre-emptively to prevent logic that decides\r\n            // if new resources are created will keep on working correctly.\r\n            this.used.push(free);\r\n            // if acquire fails also pending validation, must be aborted so that pre reserved\r\n            // resource will be returned to free resources immediately\r\n            const abortAbleValidation = new PendingOperation_1.PendingOperation(this.acquireTimeoutMillis);\r\n            // eslint-disable-next-line\r\n            pendingAcquire.promise.catch(err => {\r\n                abortAbleValidation.abort();\r\n            });\r\n            abortAbleValidation.promise\r\n                .catch(err => {\r\n                // There's nothing we can do here but log the error. This would otherwise\r\n                // leak out as an unhandled exception.\r\n                this.log('Tarn: resource validator threw an exception ' + err.stack, 'warn');\r\n                return false;\r\n            })\r\n                .then(validationSuccess => {\r\n                try {\r\n                    if (validationSuccess && !pendingAcquire.isRejected) {\r\n                        // At least one active resource exist, start reaping.\r\n                        this._startReaping();\r\n                        pendingAcquire.resolve(free.resource);\r\n                    }\r\n                    else {\r\n                        remove(this.used, free);\r\n                        // Only destroy the resource if the validation has failed\r\n                        if (!validationSuccess) {\r\n                            this._destroy(free.resource);\r\n                            // Since we destroyed an invalid resource and were not able to fulfill\r\n                            // all the pending acquires, we may need to create new ones or at\r\n                            // least run this acquire loop again to verify it. But not immediately\r\n                            // to prevent starving event loop.\r\n                            setTimeout(() => {\r\n                                this._tryAcquireOrCreate();\r\n                            }, 0);\r\n                        }\r\n                        else {\r\n                            this.free.push(free);\r\n                        }\r\n                        // is acquire was canceled, failed or timed out already\r\n                        // no need to return it to pending queries\r\n                        if (!pendingAcquire.isRejected) {\r\n                            this.pendingAcquires.unshift(pendingAcquire);\r\n                        }\r\n                    }\r\n                }\r\n                finally {\r\n                    remove(this.pendingValidations, pendingAcquire);\r\n                }\r\n            });\r\n            // try to validate\r\n            this._validateResource(free.resource)\r\n                .then(validationSuccess => {\r\n                abortAbleValidation.resolve(validationSuccess);\r\n            })\r\n                .catch(err => {\r\n                abortAbleValidation.reject(err);\r\n            });\r\n        }\r\n    }\r\n    _canAcquire() {\r\n        return this.free.length > 0 && this.pendingAcquires.length > 0;\r\n    }\r\n    _validateResource(resource) {\r\n        try {\r\n            return Promise.resolve(this.validate(resource));\r\n        }\r\n        catch (err) {\r\n            // prevent leaking of sync exception\r\n            return Promise.reject(err);\r\n        }\r\n    }\r\n    _shouldCreateMoreResources() {\r\n        return (this.used.length + this.pendingCreates.length < this.max &&\r\n            this.pendingCreates.length < this.pendingAcquires.length);\r\n    }\r\n    _doCreate() {\r\n        const pendingAcquiresBeforeCreate = this.pendingAcquires.slice();\r\n        const pendingCreate = this._create();\r\n        pendingCreate.promise\r\n            .then(() => {\r\n            // Not returned on purpose.\r\n            this._tryAcquireOrCreate();\r\n            return null;\r\n        })\r\n            .catch(err => {\r\n            if (this.propagateCreateError && this.pendingAcquires.length !== 0) {\r\n                // If propagateCreateError is true, we don't retry the create\r\n                // but reject the first pending acquire immediately. Intentionally\r\n                // use `this.pendingAcquires` instead of `pendingAcquiresBeforeCreate`\r\n                // in case some acquires in pendingAcquiresBeforeCreate have already\r\n                // been resolved.\r\n                this.pendingAcquires[0].reject(err);\r\n            }\r\n            // Save the create error to all pending acquires so that we can use it\r\n            // as the error to reject the acquire if it times out.\r\n            pendingAcquiresBeforeCreate.forEach(pendingAcquire => {\r\n                pendingAcquire.possibleTimeoutCause = err;\r\n            });\r\n            // Not returned on purpose.\r\n            utils_1.delay(this.createRetryIntervalMillis).then(() => this._tryAcquireOrCreate());\r\n        });\r\n    }\r\n    _create() {\r\n        const eventId = this.eventId++;\r\n        this._executeEventHandlers('createRequest', eventId);\r\n        const pendingCreate = new PendingOperation_1.PendingOperation(this.createTimeoutMillis);\r\n        // If an error occurs (likely a create timeout) remove this creation from\r\n        // the list of pending creations so we try to create a new one.\r\n        pendingCreate.promise = pendingCreate.promise.catch(err => {\r\n            if (remove(this.pendingCreates, pendingCreate)) {\r\n                // TODO: figure out more consistent way for different error handlers in next rewrite\r\n                this._executeEventHandlers('createFail', eventId, err);\r\n            }\r\n            throw err;\r\n        });\r\n        this.pendingCreates.push(pendingCreate);\r\n        callbackOrPromise(this.creator)\r\n            .then(resource => {\r\n            if (pendingCreate.isRejected) {\r\n                this.destroyer(resource);\r\n                return null;\r\n            }\r\n            remove(this.pendingCreates, pendingCreate);\r\n            this.free.push(new Resource_1.Resource(resource));\r\n            // Not returned on purpose.\r\n            pendingCreate.resolve(resource);\r\n            this._executeEventHandlers('createSuccess', eventId, resource);\r\n            return null;\r\n        })\r\n            .catch(err => {\r\n            if (pendingCreate.isRejected) {\r\n                return null;\r\n            }\r\n            if (remove(this.pendingCreates, pendingCreate)) {\r\n                this._executeEventHandlers('createFail', eventId, err);\r\n            }\r\n            // Not returned on purpose.\r\n            pendingCreate.reject(err);\r\n            return null;\r\n        });\r\n        return pendingCreate;\r\n    }\r\n    _destroy(resource) {\r\n        const eventId = this.eventId++;\r\n        this._executeEventHandlers('destroyRequest', eventId, resource);\r\n        // this.destroyer can be both synchronous and asynchronous.\r\n        // so we wrap it to promise to get all exceptions through same pipeline\r\n        const pendingDestroy = new PendingOperation_1.PendingOperation(this.destroyTimeoutMillis);\r\n        const retVal = Promise.resolve().then(() => this.destroyer(resource));\r\n        retVal\r\n            .then(() => {\r\n            pendingDestroy.resolve(resource);\r\n        })\r\n            .catch((err) => {\r\n            pendingDestroy.reject(err);\r\n        });\r\n        this.pendingDestroys.push(pendingDestroy);\r\n        // In case of an error there's nothing we can do here but log it.\r\n        return pendingDestroy.promise\r\n            .then(res => {\r\n            this._executeEventHandlers('destroySuccess', eventId, resource);\r\n            return res;\r\n        })\r\n            .catch(err => this._logDestroyerError(eventId, resource, err))\r\n            .then(res => {\r\n            const index = this.pendingDestroys.findIndex(pd => pd === pendingDestroy);\r\n            this.pendingDestroys.splice(index, 1);\r\n            return res;\r\n        });\r\n    }\r\n    _logDestroyerError(eventId, resource, err) {\r\n        this._executeEventHandlers('destroyFail', eventId, resource, err);\r\n        this.log('Tarn: resource destroyer threw an exception ' + err.stack, 'warn');\r\n    }\r\n    _startReaping() {\r\n        if (!this.interval) {\r\n            this._executeEventHandlers('startReaping');\r\n            this.interval = setInterval(() => this.check(), this.reapIntervalMillis);\r\n        }\r\n    }\r\n    _stopReaping() {\r\n        if (this.interval !== null) {\r\n            this._executeEventHandlers('stopReaping');\r\n            timers_1.clearInterval(this.interval);\r\n        }\r\n        this.interval = null;\r\n    }\r\n    _executeEventHandlers(eventName, ...args) {\r\n        const listeners = this.emitter.listeners(eventName);\r\n        // just calling .emit() would stop running rest of the listeners if one them fails\r\n        listeners.forEach(listener => {\r\n            try {\r\n                listener(...args);\r\n            }\r\n            catch (err) {\r\n                // There's nothing we can do here but log the error. This would otherwise\r\n                // leak out as an unhandled exception.\r\n                this.log(`Tarn: event handler \"${eventName}\" threw an exception ${err.stack}`, 'warn');\r\n            }\r\n        });\r\n    }\r\n}\r\nexports.Pool = Pool;\r\nfunction remove(arr, item) {\r\n    const idx = arr.indexOf(item);\r\n    if (idx === -1) {\r\n        return false;\r\n    }\r\n    else {\r\n        arr.splice(idx, 1);\r\n        return true;\r\n    }\r\n}\r\nfunction callbackOrPromise(func) {\r\n    return new Promise((resolve, reject) => {\r\n        const callback = (err, resource) => {\r\n            if (err) {\r\n                reject(err);\r\n            }\r\n            else {\r\n                resolve(resource);\r\n            }\r\n        };\r\n        utils_1.tryPromise(() => func(callback))\r\n            .then(res => {\r\n            // If the result is falsy, we assume that the callback will\r\n            // be called instead of interpreting the falsy value as a\r\n            // result value.\r\n            if (res) {\r\n                resolve(res);\r\n            }\r\n        })\r\n            .catch(err => {\r\n            reject(err);\r\n        });\r\n    });\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdGFybi9kaXN0L1Bvb2wuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsMkJBQTJCLG1CQUFPLENBQUMsOEVBQW9CO0FBQ3ZELG1CQUFtQixtQkFBTyxDQUFDLDhEQUFZO0FBQ3ZDLGdCQUFnQixtQkFBTyxDQUFDLHdEQUFTO0FBQ2pDLGlCQUFpQixtQkFBTyxDQUFDLHNCQUFRO0FBQ2pDLGlCQUFpQixtQkFBTyxDQUFDLHNCQUFRO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsSUFBSTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxPQUFPO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxXQUFXO0FBQzdDLHdFQUF3RSxXQUFXO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxVQUFVLHVCQUF1QixVQUFVO0FBQzVGO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0wiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtdHlwZXNjcmlwdC1yZWR1eC1zYW1wbGUvLi9ub2RlX21vZHVsZXMvdGFybi9kaXN0L1Bvb2wuanM/M2YzNyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCBQZW5kaW5nT3BlcmF0aW9uXzEgPSByZXF1aXJlKFwiLi9QZW5kaW5nT3BlcmF0aW9uXCIpO1xyXG5jb25zdCBSZXNvdXJjZV8xID0gcmVxdWlyZShcIi4vUmVzb3VyY2VcIik7XHJcbmNvbnN0IHV0aWxzXzEgPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcclxuY29uc3QgZXZlbnRzXzEgPSByZXF1aXJlKFwiZXZlbnRzXCIpO1xyXG5jb25zdCB0aW1lcnNfMSA9IHJlcXVpcmUoXCJ0aW1lcnNcIik7XHJcbmNsYXNzIFBvb2wge1xyXG4gICAgY29uc3RydWN0b3Iob3B0KSB7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVtaXR0ZXIgPSBuZXcgZXZlbnRzXzEuRXZlbnRFbWl0dGVyKCk7XHJcbiAgICAgICAgb3B0ID0gb3B0IHx8IHt9O1xyXG4gICAgICAgIGlmICghb3B0LmNyZWF0ZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rhcm46IG9wdC5jcmVhdGUgZnVuY3Rpb24gbW9zdCBiZSBwcm92aWRlZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIW9wdC5kZXN0cm95KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGFybjogb3B0LmRlc3Ryb3kgZnVuY3Rpb24gbW9zdCBiZSBwcm92aWRlZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZW9mIG9wdC5taW4gIT09ICdudW1iZXInIHx8IG9wdC5taW4gPCAwIHx8IG9wdC5taW4gIT09IE1hdGgucm91bmQob3B0Lm1pbikpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUYXJuOiBvcHQubWluIG11c3QgYmUgYW4gaW50ZWdlciA+PSAwJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2Ygb3B0Lm1heCAhPT0gJ251bWJlcicgfHwgb3B0Lm1heCA8PSAwIHx8IG9wdC5tYXggIT09IE1hdGgucm91bmQob3B0Lm1heCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUYXJuOiBvcHQubWF4IG11c3QgYmUgYW4gaW50ZWdlciA+IDAnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9wdC5taW4gPiBvcHQubWF4KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGFybjogb3B0Lm1heCBpcyBzbWFsbGVyIHRoYW4gb3B0Lm1pbicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXV0aWxzXzEuY2hlY2tPcHRpb25hbFRpbWUob3B0LmFjcXVpcmVUaW1lb3V0TWlsbGlzKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rhcm46IGludmFsaWQgb3B0LmFjcXVpcmVUaW1lb3V0TWlsbGlzICcgKyBKU09OLnN0cmluZ2lmeShvcHQuYWNxdWlyZVRpbWVvdXRNaWxsaXMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF1dGlsc18xLmNoZWNrT3B0aW9uYWxUaW1lKG9wdC5jcmVhdGVUaW1lb3V0TWlsbGlzKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rhcm46IGludmFsaWQgb3B0LmNyZWF0ZVRpbWVvdXRNaWxsaXMgJyArIEpTT04uc3RyaW5naWZ5KG9wdC5jcmVhdGVUaW1lb3V0TWlsbGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdXRpbHNfMS5jaGVja09wdGlvbmFsVGltZShvcHQuZGVzdHJveVRpbWVvdXRNaWxsaXMpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGFybjogaW52YWxpZCBvcHQuZGVzdHJveVRpbWVvdXRNaWxsaXMgJyArIEpTT04uc3RyaW5naWZ5KG9wdC5kZXN0cm95VGltZW91dE1pbGxpcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXV0aWxzXzEuY2hlY2tPcHRpb25hbFRpbWUob3B0LmlkbGVUaW1lb3V0TWlsbGlzKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Rhcm46IGludmFsaWQgb3B0LmlkbGVUaW1lb3V0TWlsbGlzICcgKyBKU09OLnN0cmluZ2lmeShvcHQuaWRsZVRpbWVvdXRNaWxsaXMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF1dGlsc18xLmNoZWNrT3B0aW9uYWxUaW1lKG9wdC5yZWFwSW50ZXJ2YWxNaWxsaXMpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGFybjogaW52YWxpZCBvcHQucmVhcEludGVydmFsTWlsbGlzICcgKyBKU09OLnN0cmluZ2lmeShvcHQucmVhcEludGVydmFsTWlsbGlzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdXRpbHNfMS5jaGVja09wdGlvbmFsVGltZShvcHQuY3JlYXRlUmV0cnlJbnRlcnZhbE1pbGxpcykpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUYXJuOiBpbnZhbGlkIG9wdC5jcmVhdGVSZXRyeUludGVydmFsTWlsbGlzICcgK1xyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkob3B0LmNyZWF0ZVJldHJ5SW50ZXJ2YWxNaWxsaXMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYWxsb3dlZEtleXMgPSB7XHJcbiAgICAgICAgICAgIGNyZWF0ZTogdHJ1ZSxcclxuICAgICAgICAgICAgdmFsaWRhdGU6IHRydWUsXHJcbiAgICAgICAgICAgIGRlc3Ryb3k6IHRydWUsXHJcbiAgICAgICAgICAgIGxvZzogdHJ1ZSxcclxuICAgICAgICAgICAgbWluOiB0cnVlLFxyXG4gICAgICAgICAgICBtYXg6IHRydWUsXHJcbiAgICAgICAgICAgIGFjcXVpcmVUaW1lb3V0TWlsbGlzOiB0cnVlLFxyXG4gICAgICAgICAgICBjcmVhdGVUaW1lb3V0TWlsbGlzOiB0cnVlLFxyXG4gICAgICAgICAgICBkZXN0cm95VGltZW91dE1pbGxpczogdHJ1ZSxcclxuICAgICAgICAgICAgaWRsZVRpbWVvdXRNaWxsaXM6IHRydWUsXHJcbiAgICAgICAgICAgIHJlYXBJbnRlcnZhbE1pbGxpczogdHJ1ZSxcclxuICAgICAgICAgICAgY3JlYXRlUmV0cnlJbnRlcnZhbE1pbGxpczogdHJ1ZSxcclxuICAgICAgICAgICAgcHJvcGFnYXRlQ3JlYXRlRXJyb3I6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKG9wdCkpIHtcclxuICAgICAgICAgICAgaWYgKCFhbGxvd2VkS2V5c1trZXldKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRhcm46IHVuc3VwcG9ydGVkIG9wdGlvbiBvcHQuJHtrZXl9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jcmVhdG9yID0gb3B0LmNyZWF0ZTtcclxuICAgICAgICB0aGlzLmRlc3Ryb3llciA9IG9wdC5kZXN0cm95O1xyXG4gICAgICAgIHRoaXMudmFsaWRhdGUgPSB0eXBlb2Ygb3B0LnZhbGlkYXRlID09PSAnZnVuY3Rpb24nID8gb3B0LnZhbGlkYXRlIDogKCkgPT4gdHJ1ZTtcclxuICAgICAgICB0aGlzLmxvZyA9IG9wdC5sb2cgfHwgKCgpID0+IHsgfSk7XHJcbiAgICAgICAgdGhpcy5hY3F1aXJlVGltZW91dE1pbGxpcyA9IG9wdC5hY3F1aXJlVGltZW91dE1pbGxpcyB8fCAzMDAwMDtcclxuICAgICAgICB0aGlzLmNyZWF0ZVRpbWVvdXRNaWxsaXMgPSBvcHQuY3JlYXRlVGltZW91dE1pbGxpcyB8fCAzMDAwMDtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lUaW1lb3V0TWlsbGlzID0gb3B0LmRlc3Ryb3lUaW1lb3V0TWlsbGlzIHx8IDUwMDA7XHJcbiAgICAgICAgdGhpcy5pZGxlVGltZW91dE1pbGxpcyA9IG9wdC5pZGxlVGltZW91dE1pbGxpcyB8fCAzMDAwMDtcclxuICAgICAgICB0aGlzLnJlYXBJbnRlcnZhbE1pbGxpcyA9IG9wdC5yZWFwSW50ZXJ2YWxNaWxsaXMgfHwgMTAwMDtcclxuICAgICAgICB0aGlzLmNyZWF0ZVJldHJ5SW50ZXJ2YWxNaWxsaXMgPSBvcHQuY3JlYXRlUmV0cnlJbnRlcnZhbE1pbGxpcyB8fCAyMDA7XHJcbiAgICAgICAgdGhpcy5wcm9wYWdhdGVDcmVhdGVFcnJvciA9ICEhb3B0LnByb3BhZ2F0ZUNyZWF0ZUVycm9yO1xyXG4gICAgICAgIHRoaXMubWluID0gb3B0Lm1pbjtcclxuICAgICAgICB0aGlzLm1heCA9IG9wdC5tYXg7XHJcbiAgICAgICAgLy8gQWxsIHRoZSByZXNvdXJjZXMsIHdoaWNoIGFyZSBlaXRoZXIgYWxyZWFkeSBhY3F1aXJlZCBvciB3aGljaCBhcmVcclxuICAgICAgICAvLyBjb25zaWRlcmVkIGZvciBiZWluZyBwYXNzZWQgdG8gYWNxdWlyZSBpbiBhc3luYyB2YWxpZGF0aW9uIHBoYXNlLlxyXG4gICAgICAgIHRoaXMudXNlZCA9IFtdO1xyXG4gICAgICAgIC8vIEFsbCB0aGUgcmVzb3VyY2VzLCB3aGljaCBhcmUgZWl0aGVyIGp1c3QgY3JlYXRlZCBhbmQgZnJlZSBvciByZXR1cm5lZFxyXG4gICAgICAgIC8vIGJhY2sgdG8gcG9vbCBhZnRlciB1c2luZy5cclxuICAgICAgICB0aGlzLmZyZWUgPSBbXTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdDcmVhdGVzID0gW107XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nQWNxdWlyZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdEZXN0cm95cyA9IFtdO1xyXG4gICAgICAgIC8vIFdoZW4gYWNxdWlyZSBpcyBwZW5kaW5nLCBidXQgYWxzbyBzdGlsbCBpbiB2YWxpZGF0aW9uIHBoYXNlXHJcbiAgICAgICAgdGhpcy5wZW5kaW5nVmFsaWRhdGlvbnMgPSBbXTtcclxuICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZXZlbnRJZCA9IDE7XHJcbiAgICB9XHJcbiAgICBudW1Vc2VkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnVzZWQubGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgbnVtRnJlZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mcmVlLmxlbmd0aDtcclxuICAgIH1cclxuICAgIG51bVBlbmRpbmdBY3F1aXJlcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZW5kaW5nQWNxdWlyZXMubGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgbnVtUGVuZGluZ1ZhbGlkYXRpb25zKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlbmRpbmdWYWxpZGF0aW9ucy5sZW5ndGg7XHJcbiAgICB9XHJcbiAgICBudW1QZW5kaW5nQ3JlYXRlcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZW5kaW5nQ3JlYXRlcy5sZW5ndGg7XHJcbiAgICB9XHJcbiAgICBhY3F1aXJlKCkge1xyXG4gICAgICAgIGNvbnN0IGV2ZW50SWQgPSB0aGlzLmV2ZW50SWQrKztcclxuICAgICAgICB0aGlzLl9leGVjdXRlRXZlbnRIYW5kbGVycygnYWNxdWlyZVJlcXVlc3QnLCBldmVudElkKTtcclxuICAgICAgICBjb25zdCBwZW5kaW5nQWNxdWlyZSA9IG5ldyBQZW5kaW5nT3BlcmF0aW9uXzEuUGVuZGluZ09wZXJhdGlvbih0aGlzLmFjcXVpcmVUaW1lb3V0TWlsbGlzKTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdBY3F1aXJlcy5wdXNoKHBlbmRpbmdBY3F1aXJlKTtcclxuICAgICAgICAvLyBJZiB0aGUgYWNxdWlyZSBmYWlscyBmb3Igd2hhdGV2ZXIgcmVhc29uXHJcbiAgICAgICAgLy8gcmVtb3ZlIGl0IGZyb20gdGhlIHBlbmRpbmcgcXVldWUuXHJcbiAgICAgICAgcGVuZGluZ0FjcXVpcmUucHJvbWlzZSA9IHBlbmRpbmdBY3F1aXJlLnByb21pc2VcclxuICAgICAgICAgICAgLnRoZW4ocmVzb3VyY2UgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9leGVjdXRlRXZlbnRIYW5kbGVycygnYWNxdWlyZVN1Y2Nlc3MnLCBldmVudElkLCByZXNvdXJjZSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fZXhlY3V0ZUV2ZW50SGFuZGxlcnMoJ2FjcXVpcmVGYWlsJywgZXZlbnRJZCwgZXJyKTtcclxuICAgICAgICAgICAgcmVtb3ZlKHRoaXMucGVuZGluZ0FjcXVpcmVzLCBwZW5kaW5nQWNxdWlyZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuX3RyeUFjcXVpcmVPckNyZWF0ZSgpO1xyXG4gICAgICAgIHJldHVybiBwZW5kaW5nQWNxdWlyZTtcclxuICAgIH1cclxuICAgIHJlbGVhc2UocmVzb3VyY2UpIHtcclxuICAgICAgICB0aGlzLl9leGVjdXRlRXZlbnRIYW5kbGVycygncmVsZWFzZScsIHJlc291cmNlKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHRoaXMudXNlZC5sZW5ndGg7IGkgPCBsOyArK2kpIHtcclxuICAgICAgICAgICAgY29uc3QgdXNlZCA9IHRoaXMudXNlZFtpXTtcclxuICAgICAgICAgICAgaWYgKHVzZWQucmVzb3VyY2UgPT09IHJlc291cmNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVzZWQuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mcmVlLnB1c2godXNlZC5yZXNvbHZlKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdHJ5QWNxdWlyZU9yQ3JlYXRlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpc0VtcHR5KCkge1xyXG4gICAgICAgIHJldHVybiAoW1xyXG4gICAgICAgICAgICB0aGlzLm51bUZyZWUoKSxcclxuICAgICAgICAgICAgdGhpcy5udW1Vc2VkKCksXHJcbiAgICAgICAgICAgIHRoaXMubnVtUGVuZGluZ0FjcXVpcmVzKCksXHJcbiAgICAgICAgICAgIHRoaXMubnVtUGVuZGluZ1ZhbGlkYXRpb25zKCksXHJcbiAgICAgICAgICAgIHRoaXMubnVtUGVuZGluZ0NyZWF0ZXMoKVxyXG4gICAgICAgIF0ucmVkdWNlKCh0b3RhbCwgdmFsdWUpID0+IHRvdGFsICsgdmFsdWUpID09PSAwKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVhcGluZyBjeWNsZS5cclxuICAgICAqL1xyXG4gICAgY2hlY2soKSB7XHJcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gdXRpbHNfMS5ub3coKTtcclxuICAgICAgICBjb25zdCBuZXdGcmVlID0gW107XHJcbiAgICAgICAgY29uc3QgbWluS2VlcCA9IHRoaXMubWluIC0gdGhpcy51c2VkLmxlbmd0aDtcclxuICAgICAgICBjb25zdCBtYXhEZXN0cm95ID0gdGhpcy5mcmVlLmxlbmd0aCAtIG1pbktlZXA7XHJcbiAgICAgICAgbGV0IG51bURlc3Ryb3llZCA9IDA7XHJcbiAgICAgICAgdGhpcy5mcmVlLmZvckVhY2goZnJlZSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh1dGlsc18xLmR1cmF0aW9uKHRpbWVzdGFtcCwgZnJlZS50aW1lc3RhbXApID49IHRoaXMuaWRsZVRpbWVvdXRNaWxsaXMgJiZcclxuICAgICAgICAgICAgICAgIG51bURlc3Ryb3llZCA8IG1heERlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgIG51bURlc3Ryb3llZCsrO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGVzdHJveShmcmVlLnJlc291cmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5ld0ZyZWUucHVzaChmcmVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZnJlZSA9IG5ld0ZyZWU7XHJcbiAgICAgICAgLy8gUG9vbCBpcyBjb21wbGV0ZWx5IGVtcHR5LCBzdG9wIHJlYXBpbmcuXHJcbiAgICAgICAgLy8gTmV4dCAuYWNxdWlyZSB3aWxsIHN0YXJ0IHJlYXBpbmcgaW50ZXJ2YWwgYWdhaW4uXHJcbiAgICAgICAgaWYgKHRoaXMuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0b3BSZWFwaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZGVzdHJveSgpIHtcclxuICAgICAgICBjb25zdCBldmVudElkID0gdGhpcy5ldmVudElkKys7XHJcbiAgICAgICAgdGhpcy5fZXhlY3V0ZUV2ZW50SGFuZGxlcnMoJ3Bvb2xEZXN0cm95UmVxdWVzdCcsIGV2ZW50SWQpO1xyXG4gICAgICAgIHRoaXMuX3N0b3BSZWFwaW5nKCk7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xyXG4gICAgICAgIC8vIEZpcnN0IHdhaXQgZm9yIGFsbCB0aGUgcGVuZGluZyBjcmVhdGVzIGdldCByZWFkeS5cclxuICAgICAgICByZXR1cm4gdXRpbHNfMS5yZWZsZWN0KFByb21pc2UuYWxsKHRoaXMucGVuZGluZ0NyZWF0ZXMubWFwKGNyZWF0ZSA9PiB1dGlsc18xLnJlZmxlY3QoY3JlYXRlLnByb21pc2UpKSlcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIHBvbGwgZXZlcnkgMTAwbXMgYW5kIHdhaXQgdGhhdCBhbGwgdmFsaWRhdGlvbnMgYXJlIHJlYWR5XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5udW1QZW5kaW5nVmFsaWRhdGlvbnMoKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5udW1QZW5kaW5nVmFsaWRhdGlvbnMoKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lcnNfMS5jbGVhckludGVydmFsKGludGVydmFsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gV2FpdCBmb3IgYWxsIHRoZSB1c2VkIHJlc291cmNlcyB0byBiZSBmcmVlZC5cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHRoaXMudXNlZC5tYXAodXNlZCA9PiB1dGlsc18xLnJlZmxlY3QodXNlZC5wcm9taXNlKSkpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gQWJvcnQgYWxsIHBlbmRpbmcgYWNxdWlyZXMuXHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbCh0aGlzLnBlbmRpbmdBY3F1aXJlcy5tYXAoYWNxdWlyZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBhY3F1aXJlLmFib3J0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHNfMS5yZWZsZWN0KGFjcXVpcmUucHJvbWlzZSk7XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIE5vdyB3ZSBjYW4gZGVzdHJveSBhbGwgdGhlIGZyZWVkIHJlc291cmNlcy5cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHRoaXMuZnJlZS5tYXAoZnJlZSA9PiB1dGlsc18xLnJlZmxlY3QodGhpcy5fZGVzdHJveShmcmVlLnJlc291cmNlKSkpKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIEFsc28gd2FpdCByZXN0IG9mIHRoZSBwZW5kaW5nIGRlc3Ryb3lzIHRvIGZpbmlzaFxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwodGhpcy5wZW5kaW5nRGVzdHJveXMubWFwKHBkID0+IHBkLnByb21pc2UpKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZnJlZSA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdBY3F1aXJlcyA9IFtdO1xyXG4gICAgICAgIH0pKS50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2V4ZWN1dGVFdmVudEhhbmRsZXJzKCdwb29sRGVzdHJveVN1Y2Nlc3MnLCBldmVudElkKTtcclxuICAgICAgICAgICAgdGhpcy5lbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgb24oZXZlbnQsIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgdGhpcy5lbWl0dGVyLm9uKGV2ZW50LCBsaXN0ZW5lcik7XHJcbiAgICB9XHJcbiAgICByZW1vdmVMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpIHtcclxuICAgICAgICB0aGlzLmVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcclxuICAgIH1cclxuICAgIHJlbW92ZUFsbExpc3RlbmVycyhldmVudCkge1xyXG4gICAgICAgIHRoaXMuZW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoZXZlbnQpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbW9zdCBpbXBvcnRhbnQgbWV0aG9kIHRoYXQgaXMgY2FsbGVkIGFsd2F5cyB3aGVuIHJlc291cmNlc1xyXG4gICAgICogYXJlIGNyZWF0ZWQgLyBkZXN0cm95ZWQgLyBhY3F1aXJlZCAvIHJlbGVhc2VkLiBJbiBvdGhlciB3b3Jkc1xyXG4gICAgICogZXZlcnkgdGltZSB3aGVuIHJlc291cmNlcyBhcmUgbW92ZWQgZnJvbSB1c2VkIHRvIGZyZWUgb3IgdmljZVxyXG4gICAgICogdmVyc2EuXHJcbiAgICAgKlxyXG4gICAgICogRWl0aGVyIGFzc2lnbnMgZnJlZSByZXNvdXJjZXMgdG8gcGVuZGluZ0FjcXVpcmVzIG9yIGNyZWF0ZXMgbmV3XHJcbiAgICAgKiByZXNvdXJjZXMgaWYgdGhlcmUgaXMgcm9vbSBmb3IgaXQgaW4gdGhlIHBvb2wuXHJcbiAgICAgKi9cclxuICAgIF90cnlBY3F1aXJlT3JDcmVhdGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGVzdHJveWVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ZyZWVSZXNvdXJjZXMoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9kb0FjcXVpcmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5fc2hvdWxkQ3JlYXRlTW9yZVJlc291cmNlcygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RvQ3JlYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX2hhc0ZyZWVSZXNvdXJjZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZnJlZS5sZW5ndGggPiAwO1xyXG4gICAgfVxyXG4gICAgX2RvQWNxdWlyZSgpIHtcclxuICAgICAgICAvLyBBY3F1aXJlIGFzIG1hbnkgcGVuZGluZyBhY3F1aXJlcyBhcyBwb3NzaWJsZSBjb25jdXJyZW50bHlcclxuICAgICAgICB3aGlsZSAodGhpcy5fY2FuQWNxdWlyZSgpKSB7XHJcbiAgICAgICAgICAgIC8vIFRvIGFsbG93IGFzeW5jIHZhbGlkYXRpb24sIHdlIGFjdHVhbGx5IG5lZWQgdG8gbW92ZSBmcmVlIHJlc291cmNlXHJcbiAgICAgICAgICAgIC8vIGFuZCBwZW5kaW5nIGFjcXVpcmUgdGVtcG9yYXJ5IGZyb20gdGhlaXIgcmVzcGVjdGl2ZSBhcnJheXMgYW5kIGRlcGVuZGluZ1xyXG4gICAgICAgICAgICAvLyBvbiB2YWxpZGF0aW9uIHJlc3VsdCB0byBlaXRoZXIgbGVhdmUgdGhlIGZyZWUgcmVzb3VyY2UgdG8gdXNlZCByZXNvdXJjZXMgYXJyYXlcclxuICAgICAgICAgICAgLy8gb3IgZGVzdHJveSB0aGUgZnJlZSByZXNvdXJjZSBpZiB2YWxpZGF0aW9uIGRpZCBmYWlsLlxyXG4gICAgICAgICAgICBjb25zdCBwZW5kaW5nQWNxdWlyZSA9IHRoaXMucGVuZGluZ0FjcXVpcmVzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGZyZWUgPSB0aGlzLmZyZWUucG9wKCk7XHJcbiAgICAgICAgICAgIGlmIChmcmVlID09PSB1bmRlZmluZWQgfHwgcGVuZGluZ0FjcXVpcmUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZXJyTWVzc2FnZSA9ICd0aGlzLmZyZWUgd2FzIGVtcHR5IHdoaWxlIHRyeWluZyB0byBhY3F1aXJlIHJlc291cmNlJztcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nKGBUYXJuOiAke2Vyck1lc3NhZ2V9YCwgJ3dhcm4nKTtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW50ZXJuYWwgZXJyb3IsIHNob3VsZCBuZXZlciBoYXBwZW4uICR7ZXJyTWVzc2FnZX1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCBwZW5kaW5nQWNxdWlyZSB0aGF0IGlzIGJlaW5nIHZhbGlkYXRlZCBpcyBub3QgbG9zdCBhbmRcclxuICAgICAgICAgICAgLy8gY2FuIGJlIGZyZWVkIHdoZW4gcG9vbCBpcyBkZXN0cm95ZWQuXHJcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ1ZhbGlkYXRpb25zLnB1c2gocGVuZGluZ0FjcXVpcmUpO1xyXG4gICAgICAgICAgICAvLyBNdXN0IGJlIGFkZGVkIGhlcmUgcHJlLWVtcHRpdmVseSB0byBwcmV2ZW50IGxvZ2ljIHRoYXQgZGVjaWRlc1xyXG4gICAgICAgICAgICAvLyBpZiBuZXcgcmVzb3VyY2VzIGFyZSBjcmVhdGVkIHdpbGwga2VlcCBvbiB3b3JraW5nIGNvcnJlY3RseS5cclxuICAgICAgICAgICAgdGhpcy51c2VkLnB1c2goZnJlZSk7XHJcbiAgICAgICAgICAgIC8vIGlmIGFjcXVpcmUgZmFpbHMgYWxzbyBwZW5kaW5nIHZhbGlkYXRpb24sIG11c3QgYmUgYWJvcnRlZCBzbyB0aGF0IHByZSByZXNlcnZlZFxyXG4gICAgICAgICAgICAvLyByZXNvdXJjZSB3aWxsIGJlIHJldHVybmVkIHRvIGZyZWUgcmVzb3VyY2VzIGltbWVkaWF0ZWx5XHJcbiAgICAgICAgICAgIGNvbnN0IGFib3J0QWJsZVZhbGlkYXRpb24gPSBuZXcgUGVuZGluZ09wZXJhdGlvbl8xLlBlbmRpbmdPcGVyYXRpb24odGhpcy5hY3F1aXJlVGltZW91dE1pbGxpcyk7XHJcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxyXG4gICAgICAgICAgICBwZW5kaW5nQWNxdWlyZS5wcm9taXNlLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgICAgICBhYm9ydEFibGVWYWxpZGF0aW9uLmFib3J0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBhYm9ydEFibGVWYWxpZGF0aW9uLnByb21pc2VcclxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhlcmUncyBub3RoaW5nIHdlIGNhbiBkbyBoZXJlIGJ1dCBsb2cgdGhlIGVycm9yLiBUaGlzIHdvdWxkIG90aGVyd2lzZVxyXG4gICAgICAgICAgICAgICAgLy8gbGVhayBvdXQgYXMgYW4gdW5oYW5kbGVkIGV4Y2VwdGlvbi5cclxuICAgICAgICAgICAgICAgIHRoaXMubG9nKCdUYXJuOiByZXNvdXJjZSB2YWxpZGF0b3IgdGhyZXcgYW4gZXhjZXB0aW9uICcgKyBlcnIuc3RhY2ssICd3YXJuJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbih2YWxpZGF0aW9uU3VjY2VzcyA9PiB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uU3VjY2VzcyAmJiAhcGVuZGluZ0FjcXVpcmUuaXNSZWplY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBdCBsZWFzdCBvbmUgYWN0aXZlIHJlc291cmNlIGV4aXN0LCBzdGFydCByZWFwaW5nLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFydFJlYXBpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0FjcXVpcmUucmVzb2x2ZShmcmVlLnJlc291cmNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZSh0aGlzLnVzZWQsIGZyZWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGRlc3Ryb3kgdGhlIHJlc291cmNlIGlmIHRoZSB2YWxpZGF0aW9uIGhhcyBmYWlsZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uU3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVzdHJveShmcmVlLnJlc291cmNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNpbmNlIHdlIGRlc3Ryb3llZCBhbiBpbnZhbGlkIHJlc291cmNlIGFuZCB3ZXJlIG5vdCBhYmxlIHRvIGZ1bGZpbGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsbCB0aGUgcGVuZGluZyBhY3F1aXJlcywgd2UgbWF5IG5lZWQgdG8gY3JlYXRlIG5ldyBvbmVzIG9yIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsZWFzdCBydW4gdGhpcyBhY3F1aXJlIGxvb3AgYWdhaW4gdG8gdmVyaWZ5IGl0LiBCdXQgbm90IGltbWVkaWF0ZWx5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byBwcmV2ZW50IHN0YXJ2aW5nIGV2ZW50IGxvb3AuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90cnlBY3F1aXJlT3JDcmVhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmVlLnB1c2goZnJlZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXMgYWNxdWlyZSB3YXMgY2FuY2VsZWQsIGZhaWxlZCBvciB0aW1lZCBvdXQgYWxyZWFkeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBubyBuZWVkIHRvIHJldHVybiBpdCB0byBwZW5kaW5nIHF1ZXJpZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwZW5kaW5nQWNxdWlyZS5pc1JlamVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdBY3F1aXJlcy51bnNoaWZ0KHBlbmRpbmdBY3F1aXJlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZSh0aGlzLnBlbmRpbmdWYWxpZGF0aW9ucywgcGVuZGluZ0FjcXVpcmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gdHJ5IHRvIHZhbGlkYXRlXHJcbiAgICAgICAgICAgIHRoaXMuX3ZhbGlkYXRlUmVzb3VyY2UoZnJlZS5yZXNvdXJjZSlcclxuICAgICAgICAgICAgICAgIC50aGVuKHZhbGlkYXRpb25TdWNjZXNzID0+IHtcclxuICAgICAgICAgICAgICAgIGFib3J0QWJsZVZhbGlkYXRpb24ucmVzb2x2ZSh2YWxpZGF0aW9uU3VjY2Vzcyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgICAgIGFib3J0QWJsZVZhbGlkYXRpb24ucmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9jYW5BY3F1aXJlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZyZWUubGVuZ3RoID4gMCAmJiB0aGlzLnBlbmRpbmdBY3F1aXJlcy5sZW5ndGggPiAwO1xyXG4gICAgfVxyXG4gICAgX3ZhbGlkYXRlUmVzb3VyY2UocmVzb3VyY2UpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMudmFsaWRhdGUocmVzb3VyY2UpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAvLyBwcmV2ZW50IGxlYWtpbmcgb2Ygc3luYyBleGNlcHRpb25cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3Nob3VsZENyZWF0ZU1vcmVSZXNvdXJjZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnVzZWQubGVuZ3RoICsgdGhpcy5wZW5kaW5nQ3JlYXRlcy5sZW5ndGggPCB0aGlzLm1heCAmJlxyXG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdDcmVhdGVzLmxlbmd0aCA8IHRoaXMucGVuZGluZ0FjcXVpcmVzLmxlbmd0aCk7XHJcbiAgICB9XHJcbiAgICBfZG9DcmVhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgcGVuZGluZ0FjcXVpcmVzQmVmb3JlQ3JlYXRlID0gdGhpcy5wZW5kaW5nQWNxdWlyZXMuc2xpY2UoKTtcclxuICAgICAgICBjb25zdCBwZW5kaW5nQ3JlYXRlID0gdGhpcy5fY3JlYXRlKCk7XHJcbiAgICAgICAgcGVuZGluZ0NyZWF0ZS5wcm9taXNlXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gTm90IHJldHVybmVkIG9uIHB1cnBvc2UuXHJcbiAgICAgICAgICAgIHRoaXMuX3RyeUFjcXVpcmVPckNyZWF0ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMucHJvcGFnYXRlQ3JlYXRlRXJyb3IgJiYgdGhpcy5wZW5kaW5nQWNxdWlyZXMubGVuZ3RoICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiBwcm9wYWdhdGVDcmVhdGVFcnJvciBpcyB0cnVlLCB3ZSBkb24ndCByZXRyeSB0aGUgY3JlYXRlXHJcbiAgICAgICAgICAgICAgICAvLyBidXQgcmVqZWN0IHRoZSBmaXJzdCBwZW5kaW5nIGFjcXVpcmUgaW1tZWRpYXRlbHkuIEludGVudGlvbmFsbHlcclxuICAgICAgICAgICAgICAgIC8vIHVzZSBgdGhpcy5wZW5kaW5nQWNxdWlyZXNgIGluc3RlYWQgb2YgYHBlbmRpbmdBY3F1aXJlc0JlZm9yZUNyZWF0ZWBcclxuICAgICAgICAgICAgICAgIC8vIGluIGNhc2Ugc29tZSBhY3F1aXJlcyBpbiBwZW5kaW5nQWNxdWlyZXNCZWZvcmVDcmVhdGUgaGF2ZSBhbHJlYWR5XHJcbiAgICAgICAgICAgICAgICAvLyBiZWVuIHJlc29sdmVkLlxyXG4gICAgICAgICAgICAgICAgdGhpcy5wZW5kaW5nQWNxdWlyZXNbMF0ucmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gU2F2ZSB0aGUgY3JlYXRlIGVycm9yIHRvIGFsbCBwZW5kaW5nIGFjcXVpcmVzIHNvIHRoYXQgd2UgY2FuIHVzZSBpdFxyXG4gICAgICAgICAgICAvLyBhcyB0aGUgZXJyb3IgdG8gcmVqZWN0IHRoZSBhY3F1aXJlIGlmIGl0IHRpbWVzIG91dC5cclxuICAgICAgICAgICAgcGVuZGluZ0FjcXVpcmVzQmVmb3JlQ3JlYXRlLmZvckVhY2gocGVuZGluZ0FjcXVpcmUgPT4ge1xyXG4gICAgICAgICAgICAgICAgcGVuZGluZ0FjcXVpcmUucG9zc2libGVUaW1lb3V0Q2F1c2UgPSBlcnI7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyBOb3QgcmV0dXJuZWQgb24gcHVycG9zZS5cclxuICAgICAgICAgICAgdXRpbHNfMS5kZWxheSh0aGlzLmNyZWF0ZVJldHJ5SW50ZXJ2YWxNaWxsaXMpLnRoZW4oKCkgPT4gdGhpcy5fdHJ5QWNxdWlyZU9yQ3JlYXRlKCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgX2NyZWF0ZSgpIHtcclxuICAgICAgICBjb25zdCBldmVudElkID0gdGhpcy5ldmVudElkKys7XHJcbiAgICAgICAgdGhpcy5fZXhlY3V0ZUV2ZW50SGFuZGxlcnMoJ2NyZWF0ZVJlcXVlc3QnLCBldmVudElkKTtcclxuICAgICAgICBjb25zdCBwZW5kaW5nQ3JlYXRlID0gbmV3IFBlbmRpbmdPcGVyYXRpb25fMS5QZW5kaW5nT3BlcmF0aW9uKHRoaXMuY3JlYXRlVGltZW91dE1pbGxpcyk7XHJcbiAgICAgICAgLy8gSWYgYW4gZXJyb3Igb2NjdXJzIChsaWtlbHkgYSBjcmVhdGUgdGltZW91dCkgcmVtb3ZlIHRoaXMgY3JlYXRpb24gZnJvbVxyXG4gICAgICAgIC8vIHRoZSBsaXN0IG9mIHBlbmRpbmcgY3JlYXRpb25zIHNvIHdlIHRyeSB0byBjcmVhdGUgYSBuZXcgb25lLlxyXG4gICAgICAgIHBlbmRpbmdDcmVhdGUucHJvbWlzZSA9IHBlbmRpbmdDcmVhdGUucHJvbWlzZS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVtb3ZlKHRoaXMucGVuZGluZ0NyZWF0ZXMsIHBlbmRpbmdDcmVhdGUpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBmaWd1cmUgb3V0IG1vcmUgY29uc2lzdGVudCB3YXkgZm9yIGRpZmZlcmVudCBlcnJvciBoYW5kbGVycyBpbiBuZXh0IHJld3JpdGVcclxuICAgICAgICAgICAgICAgIHRoaXMuX2V4ZWN1dGVFdmVudEhhbmRsZXJzKCdjcmVhdGVGYWlsJywgZXZlbnRJZCwgZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nQ3JlYXRlcy5wdXNoKHBlbmRpbmdDcmVhdGUpO1xyXG4gICAgICAgIGNhbGxiYWNrT3JQcm9taXNlKHRoaXMuY3JlYXRvcilcclxuICAgICAgICAgICAgLnRoZW4ocmVzb3VyY2UgPT4ge1xyXG4gICAgICAgICAgICBpZiAocGVuZGluZ0NyZWF0ZS5pc1JlamVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3llcihyZXNvdXJjZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZW1vdmUodGhpcy5wZW5kaW5nQ3JlYXRlcywgcGVuZGluZ0NyZWF0ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuZnJlZS5wdXNoKG5ldyBSZXNvdXJjZV8xLlJlc291cmNlKHJlc291cmNlKSk7XHJcbiAgICAgICAgICAgIC8vIE5vdCByZXR1cm5lZCBvbiBwdXJwb3NlLlxyXG4gICAgICAgICAgICBwZW5kaW5nQ3JlYXRlLnJlc29sdmUocmVzb3VyY2UpO1xyXG4gICAgICAgICAgICB0aGlzLl9leGVjdXRlRXZlbnRIYW5kbGVycygnY3JlYXRlU3VjY2VzcycsIGV2ZW50SWQsIHJlc291cmNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgICAgIGlmIChwZW5kaW5nQ3JlYXRlLmlzUmVqZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyZW1vdmUodGhpcy5wZW5kaW5nQ3JlYXRlcywgcGVuZGluZ0NyZWF0ZSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2V4ZWN1dGVFdmVudEhhbmRsZXJzKCdjcmVhdGVGYWlsJywgZXZlbnRJZCwgZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBOb3QgcmV0dXJuZWQgb24gcHVycG9zZS5cclxuICAgICAgICAgICAgcGVuZGluZ0NyZWF0ZS5yZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHBlbmRpbmdDcmVhdGU7XHJcbiAgICB9XHJcbiAgICBfZGVzdHJveShyZXNvdXJjZSkge1xyXG4gICAgICAgIGNvbnN0IGV2ZW50SWQgPSB0aGlzLmV2ZW50SWQrKztcclxuICAgICAgICB0aGlzLl9leGVjdXRlRXZlbnRIYW5kbGVycygnZGVzdHJveVJlcXVlc3QnLCBldmVudElkLCByZXNvdXJjZSk7XHJcbiAgICAgICAgLy8gdGhpcy5kZXN0cm95ZXIgY2FuIGJlIGJvdGggc3luY2hyb25vdXMgYW5kIGFzeW5jaHJvbm91cy5cclxuICAgICAgICAvLyBzbyB3ZSB3cmFwIGl0IHRvIHByb21pc2UgdG8gZ2V0IGFsbCBleGNlcHRpb25zIHRocm91Z2ggc2FtZSBwaXBlbGluZVxyXG4gICAgICAgIGNvbnN0IHBlbmRpbmdEZXN0cm95ID0gbmV3IFBlbmRpbmdPcGVyYXRpb25fMS5QZW5kaW5nT3BlcmF0aW9uKHRoaXMuZGVzdHJveVRpbWVvdXRNaWxsaXMpO1xyXG4gICAgICAgIGNvbnN0IHJldFZhbCA9IFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4gdGhpcy5kZXN0cm95ZXIocmVzb3VyY2UpKTtcclxuICAgICAgICByZXRWYWxcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBwZW5kaW5nRGVzdHJveS5yZXNvbHZlKHJlc291cmNlKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBwZW5kaW5nRGVzdHJveS5yZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdEZXN0cm95cy5wdXNoKHBlbmRpbmdEZXN0cm95KTtcclxuICAgICAgICAvLyBJbiBjYXNlIG9mIGFuIGVycm9yIHRoZXJlJ3Mgbm90aGluZyB3ZSBjYW4gZG8gaGVyZSBidXQgbG9nIGl0LlxyXG4gICAgICAgIHJldHVybiBwZW5kaW5nRGVzdHJveS5wcm9taXNlXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2V4ZWN1dGVFdmVudEhhbmRsZXJzKCdkZXN0cm95U3VjY2VzcycsIGV2ZW50SWQsIHJlc291cmNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHRoaXMuX2xvZ0Rlc3Ryb3llckVycm9yKGV2ZW50SWQsIHJlc291cmNlLCBlcnIpKVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucGVuZGluZ0Rlc3Ryb3lzLmZpbmRJbmRleChwZCA9PiBwZCA9PT0gcGVuZGluZ0Rlc3Ryb3kpO1xyXG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdEZXN0cm95cy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgX2xvZ0Rlc3Ryb3llckVycm9yKGV2ZW50SWQsIHJlc291cmNlLCBlcnIpIHtcclxuICAgICAgICB0aGlzLl9leGVjdXRlRXZlbnRIYW5kbGVycygnZGVzdHJveUZhaWwnLCBldmVudElkLCByZXNvdXJjZSwgZXJyKTtcclxuICAgICAgICB0aGlzLmxvZygnVGFybjogcmVzb3VyY2UgZGVzdHJveWVyIHRocmV3IGFuIGV4Y2VwdGlvbiAnICsgZXJyLnN0YWNrLCAnd2FybicpO1xyXG4gICAgfVxyXG4gICAgX3N0YXJ0UmVhcGluZygpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaW50ZXJ2YWwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZXhlY3V0ZUV2ZW50SGFuZGxlcnMoJ3N0YXJ0UmVhcGluZycpO1xyXG4gICAgICAgICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5jaGVjaygpLCB0aGlzLnJlYXBJbnRlcnZhbE1pbGxpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3N0b3BSZWFwaW5nKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmludGVydmFsICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2V4ZWN1dGVFdmVudEhhbmRsZXJzKCdzdG9wUmVhcGluZycpO1xyXG4gICAgICAgICAgICB0aW1lcnNfMS5jbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmludGVydmFsID0gbnVsbDtcclxuICAgIH1cclxuICAgIF9leGVjdXRlRXZlbnRIYW5kbGVycyhldmVudE5hbWUsIC4uLmFyZ3MpIHtcclxuICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmVtaXR0ZXIubGlzdGVuZXJzKGV2ZW50TmFtZSk7XHJcbiAgICAgICAgLy8ganVzdCBjYWxsaW5nIC5lbWl0KCkgd291bGQgc3RvcCBydW5uaW5nIHJlc3Qgb2YgdGhlIGxpc3RlbmVycyBpZiBvbmUgdGhlbSBmYWlsc1xyXG4gICAgICAgIGxpc3RlbmVycy5mb3JFYWNoKGxpc3RlbmVyID0+IHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGxpc3RlbmVyKC4uLmFyZ3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoZXJlJ3Mgbm90aGluZyB3ZSBjYW4gZG8gaGVyZSBidXQgbG9nIHRoZSBlcnJvci4gVGhpcyB3b3VsZCBvdGhlcndpc2VcclxuICAgICAgICAgICAgICAgIC8vIGxlYWsgb3V0IGFzIGFuIHVuaGFuZGxlZCBleGNlcHRpb24uXHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZyhgVGFybjogZXZlbnQgaGFuZGxlciBcIiR7ZXZlbnROYW1lfVwiIHRocmV3IGFuIGV4Y2VwdGlvbiAke2Vyci5zdGFja31gLCAnd2FybicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5Qb29sID0gUG9vbDtcclxuZnVuY3Rpb24gcmVtb3ZlKGFyciwgaXRlbSkge1xyXG4gICAgY29uc3QgaWR4ID0gYXJyLmluZGV4T2YoaXRlbSk7XHJcbiAgICBpZiAoaWR4ID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGFyci5zcGxpY2UoaWR4LCAxKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjYWxsYmFja09yUHJvbWlzZShmdW5jKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gKGVyciwgcmVzb3VyY2UpID0+IHtcclxuICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc291cmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdXRpbHNfMS50cnlQcm9taXNlKCgpID0+IGZ1bmMoY2FsbGJhY2spKVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAvLyBJZiB0aGUgcmVzdWx0IGlzIGZhbHN5LCB3ZSBhc3N1bWUgdGhhdCB0aGUgY2FsbGJhY2sgd2lsbFxyXG4gICAgICAgICAgICAvLyBiZSBjYWxsZWQgaW5zdGVhZCBvZiBpbnRlcnByZXRpbmcgdGhlIGZhbHN5IHZhbHVlIGFzIGFcclxuICAgICAgICAgICAgLy8gcmVzdWx0IHZhbHVlLlxyXG4gICAgICAgICAgICBpZiAocmVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/tarn/dist/Pool.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/tarn/dist/PromiseInspection.js":
/*!*****************************************************!*\
  !*** ./node_modules/tarn/dist/PromiseInspection.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nclass PromiseInspection {\r\n    constructor(args) {\r\n        this._value = args.value;\r\n        this._error = args.error;\r\n    }\r\n    value() {\r\n        return this._value;\r\n    }\r\n    reason() {\r\n        return this._error;\r\n    }\r\n    isRejected() {\r\n        return !!this._error;\r\n    }\r\n    isFulfilled() {\r\n        return !!this._value;\r\n    }\r\n}\r\nexports.PromiseInspection = PromiseInspection;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdGFybi9kaXN0L1Byb21pc2VJbnNwZWN0aW9uLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRqcy10eXBlc2NyaXB0LXJlZHV4LXNhbXBsZS8uL25vZGVfbW9kdWxlcy90YXJuL2Rpc3QvUHJvbWlzZUluc3BlY3Rpb24uanM/YWExZiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jbGFzcyBQcm9taXNlSW5zcGVjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihhcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fdmFsdWUgPSBhcmdzLnZhbHVlO1xyXG4gICAgICAgIHRoaXMuX2Vycm9yID0gYXJncy5lcnJvcjtcclxuICAgIH1cclxuICAgIHZhbHVlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcclxuICAgIH1cclxuICAgIHJlYXNvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZXJyb3I7XHJcbiAgICB9XHJcbiAgICBpc1JlamVjdGVkKCkge1xyXG4gICAgICAgIHJldHVybiAhIXRoaXMuX2Vycm9yO1xyXG4gICAgfVxyXG4gICAgaXNGdWxmaWxsZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuICEhdGhpcy5fdmFsdWU7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5Qcm9taXNlSW5zcGVjdGlvbiA9IFByb21pc2VJbnNwZWN0aW9uO1xyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/tarn/dist/PromiseInspection.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/tarn/dist/Resource.js":
/*!********************************************!*\
  !*** ./node_modules/tarn/dist/Resource.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nconst utils_1 = __webpack_require__(/*! ./utils */ \"(rsc)/./node_modules/tarn/dist/utils.js\");\r\nclass Resource {\r\n    constructor(resource) {\r\n        this.resource = resource;\r\n        this.resource = resource;\r\n        this.timestamp = utils_1.now();\r\n        this.deferred = utils_1.defer();\r\n    }\r\n    get promise() {\r\n        return this.deferred.promise;\r\n    }\r\n    resolve() {\r\n        this.deferred.resolve(undefined);\r\n        return new Resource(this.resource);\r\n    }\r\n}\r\nexports.Resource = Resource;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdGFybi9kaXN0L1Jlc291cmNlLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGdCQUFnQixtQkFBTyxDQUFDLHdEQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRqcy10eXBlc2NyaXB0LXJlZHV4LXNhbXBsZS8uL25vZGVfbW9kdWxlcy90YXJuL2Rpc3QvUmVzb3VyY2UuanM/OTc2NyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCB1dGlsc18xID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XHJcbmNsYXNzIFJlc291cmNlIHtcclxuICAgIGNvbnN0cnVjdG9yKHJlc291cmNlKSB7XHJcbiAgICAgICAgdGhpcy5yZXNvdXJjZSA9IHJlc291cmNlO1xyXG4gICAgICAgIHRoaXMucmVzb3VyY2UgPSByZXNvdXJjZTtcclxuICAgICAgICB0aGlzLnRpbWVzdGFtcCA9IHV0aWxzXzEubm93KCk7XHJcbiAgICAgICAgdGhpcy5kZWZlcnJlZCA9IHV0aWxzXzEuZGVmZXIoKTtcclxuICAgIH1cclxuICAgIGdldCBwcm9taXNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmVycmVkLnByb21pc2U7XHJcbiAgICB9XHJcbiAgICByZXNvbHZlKCkge1xyXG4gICAgICAgIHRoaXMuZGVmZXJyZWQucmVzb2x2ZSh1bmRlZmluZWQpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUmVzb3VyY2UodGhpcy5yZXNvdXJjZSk7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5SZXNvdXJjZSA9IFJlc291cmNlO1xyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/tarn/dist/Resource.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/tarn/dist/TimeoutError.js":
/*!************************************************!*\
  !*** ./node_modules/tarn/dist/TimeoutError.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nclass TimeoutError extends Error {\r\n}\r\nexports.TimeoutError = TimeoutError;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdGFybi9kaXN0L1RpbWVvdXRFcnJvci5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RDtBQUNBO0FBQ0Esb0JBQW9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGpzLXR5cGVzY3JpcHQtcmVkdXgtc2FtcGxlLy4vbm9kZV9tb2R1bGVzL3Rhcm4vZGlzdC9UaW1lb3V0RXJyb3IuanM/NzQ5NyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jbGFzcyBUaW1lb3V0RXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcbn1cclxuZXhwb3J0cy5UaW1lb3V0RXJyb3IgPSBUaW1lb3V0RXJyb3I7XHJcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/tarn/dist/TimeoutError.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/tarn/dist/tarn.js":
/*!****************************************!*\
  !*** ./node_modules/tarn/dist/tarn.js ***!
  \****************************************/
/***/ ((module, exports, __webpack_require__) => {

eval("\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nconst Pool_1 = __webpack_require__(/*! ./Pool */ \"(rsc)/./node_modules/tarn/dist/Pool.js\");\r\nexports.Pool = Pool_1.Pool;\r\nconst TimeoutError_1 = __webpack_require__(/*! ./TimeoutError */ \"(rsc)/./node_modules/tarn/dist/TimeoutError.js\");\r\nexports.TimeoutError = TimeoutError_1.TimeoutError;\r\nmodule.exports = {\r\n    Pool: Pool_1.Pool,\r\n    TimeoutError: TimeoutError_1.TimeoutError\r\n};\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdGFybi9kaXN0L3Rhcm4uanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsZUFBZSxtQkFBTyxDQUFDLHNEQUFRO0FBQy9CLFlBQVk7QUFDWix1QkFBdUIsbUJBQU8sQ0FBQyxzRUFBZ0I7QUFDL0Msb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGpzLXR5cGVzY3JpcHQtcmVkdXgtc2FtcGxlLy4vbm9kZV9tb2R1bGVzL3Rhcm4vZGlzdC90YXJuLmpzPzJjZTAiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3QgUG9vbF8xID0gcmVxdWlyZShcIi4vUG9vbFwiKTtcclxuZXhwb3J0cy5Qb29sID0gUG9vbF8xLlBvb2w7XHJcbmNvbnN0IFRpbWVvdXRFcnJvcl8xID0gcmVxdWlyZShcIi4vVGltZW91dEVycm9yXCIpO1xyXG5leHBvcnRzLlRpbWVvdXRFcnJvciA9IFRpbWVvdXRFcnJvcl8xLlRpbWVvdXRFcnJvcjtcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBQb29sOiBQb29sXzEuUG9vbCxcclxuICAgIFRpbWVvdXRFcnJvcjogVGltZW91dEVycm9yXzEuVGltZW91dEVycm9yXHJcbn07XHJcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/tarn/dist/tarn.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/tarn/dist/utils.js":
/*!*****************************************!*\
  !*** ./node_modules/tarn/dist/utils.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\r\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\r\nconst PromiseInspection_1 = __webpack_require__(/*! ./PromiseInspection */ \"(rsc)/./node_modules/tarn/dist/PromiseInspection.js\");\r\nfunction defer() {\r\n    let resolve = null;\r\n    let reject = null;\r\n    const promise = new Promise((resolver, rejecter) => {\r\n        resolve = resolver;\r\n        reject = rejecter;\r\n    });\r\n    return {\r\n        promise,\r\n        resolve,\r\n        reject\r\n    };\r\n}\r\nexports.defer = defer;\r\nfunction now() {\r\n    return Date.now();\r\n}\r\nexports.now = now;\r\nfunction duration(t1, t2) {\r\n    return Math.abs(t2 - t1);\r\n}\r\nexports.duration = duration;\r\nfunction checkOptionalTime(time) {\r\n    if (typeof time === 'undefined') {\r\n        return true;\r\n    }\r\n    return checkRequiredTime(time);\r\n}\r\nexports.checkOptionalTime = checkOptionalTime;\r\nfunction checkRequiredTime(time) {\r\n    return typeof time === 'number' && time === Math.round(time) && time > 0;\r\n}\r\nexports.checkRequiredTime = checkRequiredTime;\r\nfunction delay(millis) {\r\n    return new Promise(resolve => setTimeout(resolve, millis));\r\n}\r\nexports.delay = delay;\r\nfunction reflect(promise) {\r\n    return promise\r\n        .then(value => {\r\n        return new PromiseInspection_1.PromiseInspection({ value });\r\n    })\r\n        .catch(error => {\r\n        return new PromiseInspection_1.PromiseInspection({ error });\r\n    });\r\n}\r\nexports.reflect = reflect;\r\nfunction tryPromise(cb) {\r\n    try {\r\n        const result = cb();\r\n        return Promise.resolve(result);\r\n    }\r\n    catch (err) {\r\n        return Promise.reject(err);\r\n    }\r\n}\r\nexports.tryPromise = tryPromise;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdGFybi9kaXN0L3V0aWxzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELDRCQUE0QixtQkFBTyxDQUFDLGdGQUFxQjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELE9BQU87QUFDbEUsS0FBSztBQUNMO0FBQ0EsMkRBQTJELE9BQU87QUFDbEUsS0FBSztBQUNMO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRqcy10eXBlc2NyaXB0LXJlZHV4LXNhbXBsZS8uL25vZGVfbW9kdWxlcy90YXJuL2Rpc3QvdXRpbHMuanM/YTE5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCBQcm9taXNlSW5zcGVjdGlvbl8xID0gcmVxdWlyZShcIi4vUHJvbWlzZUluc3BlY3Rpb25cIik7XHJcbmZ1bmN0aW9uIGRlZmVyKCkge1xyXG4gICAgbGV0IHJlc29sdmUgPSBudWxsO1xyXG4gICAgbGV0IHJlamVjdCA9IG51bGw7XHJcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmVyLCByZWplY3RlcikgPT4ge1xyXG4gICAgICAgIHJlc29sdmUgPSByZXNvbHZlcjtcclxuICAgICAgICByZWplY3QgPSByZWplY3RlcjtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBwcm9taXNlLFxyXG4gICAgICAgIHJlc29sdmUsXHJcbiAgICAgICAgcmVqZWN0XHJcbiAgICB9O1xyXG59XHJcbmV4cG9ydHMuZGVmZXIgPSBkZWZlcjtcclxuZnVuY3Rpb24gbm93KCkge1xyXG4gICAgcmV0dXJuIERhdGUubm93KCk7XHJcbn1cclxuZXhwb3J0cy5ub3cgPSBub3c7XHJcbmZ1bmN0aW9uIGR1cmF0aW9uKHQxLCB0Mikge1xyXG4gICAgcmV0dXJuIE1hdGguYWJzKHQyIC0gdDEpO1xyXG59XHJcbmV4cG9ydHMuZHVyYXRpb24gPSBkdXJhdGlvbjtcclxuZnVuY3Rpb24gY2hlY2tPcHRpb25hbFRpbWUodGltZSkge1xyXG4gICAgaWYgKHR5cGVvZiB0aW1lID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNoZWNrUmVxdWlyZWRUaW1lKHRpbWUpO1xyXG59XHJcbmV4cG9ydHMuY2hlY2tPcHRpb25hbFRpbWUgPSBjaGVja09wdGlvbmFsVGltZTtcclxuZnVuY3Rpb24gY2hlY2tSZXF1aXJlZFRpbWUodGltZSkge1xyXG4gICAgcmV0dXJuIHR5cGVvZiB0aW1lID09PSAnbnVtYmVyJyAmJiB0aW1lID09PSBNYXRoLnJvdW5kKHRpbWUpICYmIHRpbWUgPiAwO1xyXG59XHJcbmV4cG9ydHMuY2hlY2tSZXF1aXJlZFRpbWUgPSBjaGVja1JlcXVpcmVkVGltZTtcclxuZnVuY3Rpb24gZGVsYXkobWlsbGlzKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1pbGxpcykpO1xyXG59XHJcbmV4cG9ydHMuZGVsYXkgPSBkZWxheTtcclxuZnVuY3Rpb24gcmVmbGVjdChwcm9taXNlKSB7XHJcbiAgICByZXR1cm4gcHJvbWlzZVxyXG4gICAgICAgIC50aGVuKHZhbHVlID0+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2VJbnNwZWN0aW9uXzEuUHJvbWlzZUluc3BlY3Rpb24oeyB2YWx1ZSB9KTtcclxuICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2VJbnNwZWN0aW9uXzEuUHJvbWlzZUluc3BlY3Rpb24oeyBlcnJvciB9KTtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydHMucmVmbGVjdCA9IHJlZmxlY3Q7XHJcbmZ1bmN0aW9uIHRyeVByb21pc2UoY2IpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gY2IoKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy50cnlQcm9taXNlID0gdHJ5UHJvbWlzZTtcclxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/tarn/dist/utils.js\n");

/***/ })

};
;